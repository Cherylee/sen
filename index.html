<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—å¤æ£®çš„å°åº—</title>
    <style>
        /* åŸºç¡€æ ·å¼ï¼Œç”¨äºæ¼”ç¤º */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        .container {
            margin: 0 auto;
            background: white;
            padding: 0.2rem;
        }
        h1 {
            font-size: 0.3rem; /* æ¼”ç¤ºç”¨çš„æå°å€¼ï¼Œå®é™…ä¼šåŠ¨æ€è®¡ç®—ï¼Œä¸‹é¢ä¼šè¯´æ˜ */
            margin-bottom: 0.3rem;
            margin-top: 0.3rem;
            color: #0d6efd;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 0.2rem;
            span{
                font-size: 0.2rem;
            }
        }
        .demo-box {
            background: #e7f5ff;
            border-radius: 0.2rem;
            padding: 0.2rem;
            margin: 0.2rem 0;
            border-left: 4px solid #0d6efd;
        }
        .remark {
            background: #fff3cd;
            border-left-color: #ffc107;
            padding: 0.15rem 0.2rem;
            border-radius: 0.1rem;
            margin: 0.2rem 0;
            font-size: 0.16rem;
        }
        button {
            background: #0d6efd;
            color: white;
            border: none;
            padding: 0.12rem 0.24rem;
            font-size: 0.18rem;
            border-radius: 0.06rem;
            cursor: pointer;
            margin-right: 0.1rem;
        }
        button:hover {
            background: #0b5ed7;
        }
        .px-value {
            font-weight: bold;
            color: #dc3545;
        }
        footer {
            margin-top: 0.3rem;
            text-align: center;
            font-size: 0.14rem;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ—å¤æ£®çš„å°åº—<span>ï¼ˆæŒ‰æ‘©æœåŠ¡ï¼‰</span></h1>
        <div class="demo-box">
            <p style="font-size: 0.16rem;">æœˆå¡</code> 10å…ƒ</p>
            <p style="font-size: 0.16rem;">å¹´å¡</code> 50å…ƒ</p>
            <p style="font-size: 0.16rem;">å­£å¡</code> 30å…ƒ</p>
        </div>
    </div>

    <script>
        (function() {
            // ---------- rem å“åº”å¼æ ¸å¿ƒé…ç½® ----------
            // è®¾è®¡ç¨¿å®½åº¦ (å•ä½: px)ï¼Œé€šå¸¸ä¸º 750 æˆ– 375
            const DESIGN_WIDTH = 750;
            // åŸºå‡†å€¼ï¼šè®¾è®¡ç¨¿ä¸Š 1rem å¯¹åº”å¤šå°‘ px (æ–¹ä¾¿è®¡ç®—ï¼Œå¸¸ç”¨ 100)
            const BASE_REM = 100;
            // å…è®¸çš„æœ€å°å±å¹•å®½åº¦ (å¯é€‰ï¼Œé˜²æ­¢æ ¹å­—ä½“è¿‡å°)
            const MIN_WIDTH = 320;
            // å…è®¸çš„æœ€å¤§å±å¹•å®½åº¦ (å¯é€‰ï¼Œé˜²æ­¢è¿‡å¤§)
            const MAX_WIDTH = 1024;

            // è·å– html æ ¹å…ƒç´ 
            const docEl = document.documentElement;
            // ç”¨äºå­˜å‚¨å½“å‰æ ¹å­—ä½“å¤§å°ï¼Œæ–¹ä¾¿å·¥å…·å‡½æ•°ä½¿ç”¨
            let currentRootFontSize = BASE_REM; // åˆå§‹é»˜è®¤

            // æ ¸å¿ƒå‡½æ•°ï¼šæ ¹æ®å½“å‰å±å¹•å®½åº¦è®¡ç®—å¹¶è®¾ç½®æ ¹å­—ä½“å¤§å°
            function setRemUnit() {
                // è·å–å±å¹•å®½åº¦ (é¦–é€‰ document.documentElement.clientWidth, å…¼å®¹æ€§æ›´å¥½)
                let screenWidth = docEl.clientWidth;
                // å¦‚æœå±å¹•å®½åº¦è¶…å‡ºé™åˆ¶ï¼Œåˆ™è¿›è¡Œè£å‰ªï¼ˆä¿è¯æé™ä¸‹çš„å¯è¯»æ€§ï¼‰
                if (screenWidth < MIN_WIDTH) screenWidth = MIN_WIDTH;
                if (screenWidth > MAX_WIDTH) screenWidth = MAX_WIDTH;

                // è®¡ç®—æ ¹å­—ä½“å¤§å°: (å±å¹•å®½åº¦ / è®¾è®¡ç¨¿å®½åº¦) * åŸºå‡†remå¯¹åº”çš„px
                // ä¾‹å¦‚ 750px å±å¹•ä¸‹: (750 / 750) * 100 = 100px â†’ 1rem = 100px
                // 375px å±å¹•ä¸‹: (375 / 750) * 100 = 50px  â†’ 1rem = 50px (ç­‰æ¯”ç¼©æ”¾)
                const rootFontSize = (screenWidth / DESIGN_WIDTH) * BASE_REM;
                currentRootFontSize = rootFontSize;

                // è®¾ç½®ç»™ html æ ¹å…ƒç´ 
                docEl.style.fontSize = rootFontSize + 'px';

                // å¯é€‰ï¼šæ›´æ–°é¡µé¢ä¸Šçš„æ˜¾ç¤ºä¿¡æ¯
                updateDisplayInfo(screenWidth, rootFontSize);
            }

            // æ›´æ–°é¡µé¢ä¸Šçš„æ˜¾ç¤ºå­—æ®µ
            function updateDisplayInfo(width, fontSize) {
                const screenSpan = document.getElementById('screenWidth');
                const rootSpan = document.getElementById('rootFontSize');
                if (screenSpan) screenSpan.innerText = width + 'px';
                if (rootSpan) rootSpan.innerText = fontSize.toFixed(2) + 'px (1rem = ' + fontSize.toFixed(2) + 'px)';
            }

            // å·¥å…·å‡½æ•°ï¼šå°†è®¾è®¡ç¨¿ä¸Šçš„ px å€¼è½¬æ¢ä¸º rem å­—ç¬¦ä¸² (ç”¨äºç¼–å†™æ ·å¼æ—¶å‚è€ƒ)
            function pxToRem(pxValue) {
                if (!pxValue && pxValue !== 0) return '';
                // åŸºäºè®¾è®¡ç¨¿åŸºå‡†: è®¾è®¡ç¨¿ä¸Š 1rem = BASE_REM pxï¼Œæ‰€ä»¥ pxè½¬rem = px / BASE_REM
                const remValue = pxValue / BASE_REM;
                return remValue + 'rem';
            }

            // å·¥å…·å‡½æ•°ï¼šå°†å½“å‰ rem å€¼è½¬æ¢ä¸ºå®é™…çš„ px å€¼ (åŸºäºå½“å‰çš„æ ¹å­—ä½“)
            function remToPx(remValue) {
                return remValue * currentRootFontSize;
            }

            // ---------- ç›‘å¬ resize äº‹ä»¶ï¼Œè‡ªé€‚åº” ----------
            // é˜²æŠ–å¤„ç†ï¼Œé¿å…é¢‘ç¹è®¡ç®—
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    setRemUnit();
                }, 100); // 100ms å»¶è¿Ÿ
            });

            // é¡µé¢åŠ è½½å®Œæˆåè®¾ç½®ä¸€æ¬¡ï¼Œå¹¶ä¸” DOM å®Œå…¨æ„å»ºåä¹Ÿæ‰§è¡Œï¼ˆé’ˆå¯¹åŠ¨æ€å†…å®¹ï¼‰
            window.addEventListener('DOMContentLoaded', function() {
                setRemUnit();
            });

            // ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œé˜²æ­¢æ ·å¼é—ªåŠ¨ï¼ˆæ³¨æ„ï¼šæ­¤æ—¶å¯èƒ½ DOM å°šæœªè§£æå®Œå…¨ï¼Œä½†æ˜¾ç¤ºæ›´æ–°å‡½æ•°ä¼šç­‰å¾…å…ƒç´ å­˜åœ¨ï¼‰
            setRemUnit();

            // ---------- é™„åŠ æ¼”ç¤ºäº¤äº’ ----------
            // ç­‰å¾… DOM åŠ è½½å®Œæˆç»‘å®šäº‹ä»¶
            window.addEventListener('DOMContentLoaded', function() {
                // æŒ‰é’®ï¼špxè½¬rem
                const btnPx2rem = document.getElementById('btnPx2rem');
                if (btnPx2rem) {
                    btnPx2rem.addEventListener('click', function() {
                        const pxVal = 16; // æ¼”ç¤º16px
                        const remVal = pxToRem(pxVal);
                        console.log(`ğŸ”¸ è®¾è®¡ç¨¿ 16px å¯¹åº” rem: ${remVal} ï¼ˆæ ·å¼å†™ ${remVal}ï¼‰`);
                        alert(`è®¾è®¡ç¨¿ 16px â†’ rem: ${remVal}\nï¼ˆåŸºäºè®¾è®¡ç¨¿åŸºå‡† ${BASE_REM}px/remï¼‰`);
                    });
                }

                // æŒ‰é’®ï¼šremè½¬px (å½“å‰å±å¹•ä¸‹)
                const btnRem2px = document.getElementById('btnRem2px');
                if (btnRem2px) {
                    btnRem2px.addEventListener('click', function() {
                        const remVal = 0.24; // æ¼”ç¤º 0.24rem
                        const pxVal = remToPx(remVal).toFixed(2);
                        console.log(`ğŸ”¸ å½“å‰å±å¹•ä¸‹ 0.24rem = ${pxVal}px (æ ¹å­—ä½“ ${currentRootFontSize.toFixed(2)}px)`);
                        alert(`å½“å‰å±å¹•ä¸‹ 0.24rem = ${pxVal}px\næ ¹å­—ä½“å¤§å°: ${currentRootFontSize.toFixed(2)}px`);
                    });
                }

                // æŒ‰é’®ï¼šæ¨¡æ‹Ÿæœ€å¤§å®½åº¦ (ç›´æ¥å¼ºåˆ¶è®¾ç½®æ ¹å­—ä½“ä¸ºMAX_WIDTHä¸‹çš„å€¼)
                const btnSetMax = document.getElementById('btnSetMax');
                if (btnSetMax) {
                    btnSetMax.addEventListener('click', function() {
                        // å¼ºåˆ¶æŒ‰ MAX_WIDTH è®¡ç®—
                        const forcedWidth = MAX_WIDTH;
                        const forcedRoot = (forcedWidth / DESIGN_WIDTH) * BASE_REM;
                        docEl.style.fontSize = forcedRoot + 'px';
                        currentRootFontSize = forcedRoot;
                        updateDisplayInfo(forcedWidth, forcedRoot);
                        console.log(`ğŸ”¸ å·²æ¨¡æ‹Ÿæœ€å¤§å®½åº¦ ${MAX_WIDTH}px, æ ¹å­—ä½“ ${forcedRoot.toFixed(2)}px`);
                    });
                }
            });

            // é¢å¤–ï¼šå½“é€šè¿‡å¼€å‘è€…å·¥å…·æ”¹å˜è®¾å¤‡æ¨¡æ‹Ÿæ—¶ï¼Œorientation change ç­‰ä¹Ÿè§¦å‘ resizeï¼Œå·²åŒ…å«
            // é’ˆå¯¹æŸäº›å¥‡è‘©æƒ…å†µï¼Œå†ä¿é™©ä¸€æ¬¡
            window.addEventListener('pageshow', function(e) {
                if (e.persisted) { // å¦‚æœæ˜¯ä»ç¼“å­˜åŠ è½½ï¼Œé‡æ–°è®¾ç½®
                    setRemUnit();
                }
            });

            // å°†å·¥å…·å‡½æ•°æš´éœ²ç»™å…¨å±€ï¼Œæ–¹ä¾¿åœ¨æ§åˆ¶å°è°ƒè¯• (å¯é€‰)
            window.remHelper = {
                pxToRem: pxToRem,
                remToPx: remToPx,
                currentRootFont: () => currentRootFontSize,
                setRemUnit: setRemUnit
            };
        })();
    </script>
</body>
</html>